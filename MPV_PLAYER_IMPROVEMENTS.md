# MPV Android æ’­æ”¾å™¨åŠŸèƒ½å®Œå–„

## é—®é¢˜æè¿°
MPV æ’­æ”¾å™¨å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š
1. âŒ æ²¡æœ‰å£°éŸ³
2. âŒ æ²¡æœ‰åŠ è½½å­—å¹•
3. âŒ ç¼ºå°‘æ’­æ”¾å™¨æ§åˆ¶æŒ‰é’®ï¼ˆå¿«è¿›/å¿«é€€ï¼‰
4. âŒ æ²¡æœ‰å­—å¹•åˆ‡æ¢åŠŸèƒ½
5. âŒ æ²¡æœ‰ç½‘é€Ÿæ˜¾ç¤º
6. âŒ æ²¡æœ‰å€é€Ÿæ’­æ”¾åŠŸèƒ½

## å·²å®ç°çš„åŠŸèƒ½

### 1. éŸ³é¢‘ä¿®å¤ âœ…
**é—®é¢˜æ ¹æº**: éŸ³é¢‘è¾“å‡ºé…ç½®ä¸æ­£ç¡®
**è§£å†³æ–¹æ¡ˆ**:
```kotlin
// ä¿®æ”¹ ActivityMPVView.initOptions()
MPVLib.setOptionString("ao", "audiotrack,opensles")  // æŒ‡å®š Android éŸ³é¢‘è¾“å‡º
MPVLib.setOptionString("audio-channels", "auto")     // è‡ªåŠ¨æ£€æµ‹å£°é“
MPVLib.setOptionString("audio-buffer", "1.0")        // éŸ³é¢‘ç¼“å†²
MPVLib.setOptionString("volume", "100")              // éŸ³é‡è®¾ç½®
```

### 2. å­—å¹•åŠŸèƒ½ âœ…
**å®ç°å†…å®¹**:
- è‡ªåŠ¨åŠ è½½ç¬¬ä¸€ä¸ªå­—å¹•
- å­—å¹•åˆ‡æ¢èœå•ï¼ˆAlertDialogï¼‰
- æ”¯æŒå…³é—­å­—å¹•
- å­—å¹•æ ·å¼é…ç½®ï¼ˆé¢œè‰²ã€è¾¹æ¡†ã€é˜´å½±ï¼‰

**å…³é”®ä»£ç **:
```kotlin
// å­—å¹•é…ç½®
MPVLib.setOptionString("sub-auto", "fuzzy")
MPVLib.setOptionString("sub-font-size", "55")
MPVLib.setOptionString("sub-color", "#FFFFFF")
MPVLib.setOptionString("sub-border-size", "2.5")

// åŠ è½½å­—å¹•
MPVLib.command("sub-add", url, "select")

// å…³é—­å­—å¹•
MPVLib.setPropertyInt("sid", 0)
```

### 3. æ’­æ”¾æ§åˆ¶æŒ‰é’® âœ…
**æ–°å¢æŒ‰é’®**:
- âª åé€€ 10 ç§’
- â¯ï¸ æ’­æ”¾/æš‚åœ
- â© å‰è¿› 10 ç§’
- ğŸ“ å­—å¹•é€‰æ‹©
- âš¡ å€é€Ÿæ’­æ”¾

**UI å¸ƒå±€**:
```
é¡¶éƒ¨æ : [è¿”å›] [æ ‡é¢˜] [ç½‘é€Ÿ] [MPVæ ‡ç­¾]
ä¸­é—´: [åé€€10ç§’] [æ’­æ”¾/æš‚åœ] [å‰è¿›10ç§’]
å·¦ä¾§: [å­—å¹•æŒ‰é’®]
åº•éƒ¨: [æ—¶é—´] [è¿›åº¦æ¡] [æ€»æ—¶é•¿] [å€é€Ÿ]
```

### 4. ç½‘é€Ÿæ˜¾ç¤º âœ…
**å®ç°æ–¹å¼**:
- æ¯ç§’è®¡ç®—ç¼“å†²åŒºå¢é•¿é€Ÿåº¦
- åŸºäºè§†é¢‘ç ç‡ä¼°ç®—ä¸‹è½½é€Ÿåº¦
- å®æ—¶æ˜¾ç¤ºåœ¨é¡¶éƒ¨æ 

**è®¡ç®—é€»è¾‘**:
```kotlin
val cacheEnd = MPVLib.getPropertyDouble("demuxer-cache-time")
val bufferDiff = cacheEnd - lastBufferPos
val bytesPerSecond = (bufferDiff * estimatedBitrate) / timeDiff
```

### 5. å€é€Ÿæ’­æ”¾ âœ…
**æ”¯æŒé€Ÿåº¦**:
- 0.5x, 0.75x, 1.0x, 1.25x, 1.5x, 2.0x

**å®ç°ä»£ç **:
```kotlin
MPVLib.setPropertyDouble("speed", currentSpeed)
```

### 6. æ€§èƒ½ä¼˜åŒ– âœ…
**ç½‘ç»œä¼˜åŒ–**:
```kotlin
MPVLib.setOptionString("network-timeout", "120")
MPVLib.setOptionString("cache-secs", "30")
MPVLib.setOptionString("demuxer-max-bytes", "150M")
MPVLib.setOptionString("demuxer-readahead-secs", "10")
```

**å¤šçº¿ç¨‹è§£ç **:
```kotlin
MPVLib.setOptionString("vd-lavc-threads", "4")  // è§†é¢‘è§£ç çº¿ç¨‹
MPVLib.setOptionString("ad-lavc-threads", "2")  // éŸ³é¢‘è§£ç çº¿ç¨‹
```

## ä¸ BetterPlayer åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | BetterPlayer | MPV Player | çŠ¶æ€ |
|------|-------------|-----------|------|
| æ’­æ”¾/æš‚åœ | âœ… | âœ… | å®Œæˆ |
| è¿›åº¦æ¡æ‹–åŠ¨ | âœ… | âœ… | å®Œæˆ |
| å¿«è¿›/å¿«é€€ | âœ… | âœ… | å®Œæˆ |
| å­—å¹•åˆ‡æ¢ | âœ… | âœ… | å®Œæˆ |
| å€é€Ÿæ’­æ”¾ | âœ… | âœ… | å®Œæˆ |
| ç½‘é€Ÿæ˜¾ç¤º | âœ… | âœ… | å®Œæˆ |
| éŸ³é‡æ§åˆ¶ | âœ… (æ‰‹åŠ¿) | âš ï¸ | ç³»ç»ŸéŸ³é‡ |
| äº®åº¦æ§åˆ¶ | âœ… (æ‰‹åŠ¿) | âŒ | å¾…å®ç° |
| ç”»é¢æ¯”ä¾‹ | âœ… | âŒ | å¾…å®ç° |
| é”å±åŠŸèƒ½ | âœ… | âŒ | å¾…å®ç° |

## æ–‡ä»¶ä¿®æ”¹æ¸…å•

### Kotlin æ–‡ä»¶
1. `MpvPlayerActivity.kt`
   - æ·»åŠ å­—å¹•æ”¯æŒ
   - æ·»åŠ å€é€Ÿæ§åˆ¶
   - æ·»åŠ ç½‘é€Ÿæ˜¾ç¤º
   - æ·»åŠ å¿«è¿›/å¿«é€€æŒ‰é’®
   - ä¿®å¤éŸ³é¢‘é…ç½®

2. `MpvPlayerPlugin.kt`
   - æ·»åŠ å­—å¹•å‚æ•°ä¼ é€’

### Dart æ–‡ä»¶
1. `mpv_android_player_page.dart`
   - ä¼ é€’å­—å¹•åˆ—è¡¨åˆ°åŸç”Ÿå±‚

## æµ‹è¯•å»ºè®®

### éŸ³é¢‘æµ‹è¯•
```bash
# æµ‹è¯•ä¸åŒéŸ³é¢‘æ ¼å¼
- AAC 2.0
- AC3 5.1
- TrueHD 7.1
- DTS-HD
```

### å­—å¹•æµ‹è¯•
```bash
# æµ‹è¯•å­—å¹•æ ¼å¼
- SRT (SubRip)
- ASS/SSA (Advanced SubStation)
- VTT (WebVTT)
```

### ç½‘ç»œæµ‹è¯•
```bash
# æµ‹è¯•ä¸åŒç½‘ç»œæ¡ä»¶
- é«˜é€Ÿç½‘ç»œ (>10 Mbps)
- ä¸­é€Ÿç½‘ç»œ (2-5 Mbps)
- æ…¢é€Ÿç½‘ç»œ (<1 Mbps)
```

## å·²çŸ¥é™åˆ¶

1. **æ‰‹åŠ¿æ§åˆ¶**: å½“å‰æœªå®ç°éŸ³é‡/äº®åº¦æ‰‹åŠ¿ï¼ˆBetterPlayer æœ‰ï¼‰
2. **ç”»é¢æ¯”ä¾‹**: æœªå®ç°ç”»é¢æ¯”ä¾‹åˆ‡æ¢åŠŸèƒ½
3. **é”å±åŠŸèƒ½**: æœªå®ç°å±å¹•é”å®šåŠŸèƒ½
4. **PIPæ¨¡å¼**: æœªå®ç°ç”»ä¸­ç”»æ¨¡å¼

## ä¸‹ä¸€æ­¥ä¼˜åŒ–å»ºè®®

### é«˜ä¼˜å…ˆçº§
1. æ·»åŠ éŸ³é‡/äº®åº¦æ‰‹åŠ¿æ§åˆ¶
2. æ·»åŠ é”å±åŠŸèƒ½
3. ä¼˜åŒ– UI æ ·å¼ï¼ˆä½¿ç”¨ Material Designï¼‰

### ä¸­ä¼˜å…ˆçº§
1. æ·»åŠ ç”»é¢æ¯”ä¾‹åˆ‡æ¢
2. æ·»åŠ æ’­æ”¾åˆ—è¡¨æ”¯æŒ
3. æ·»åŠ æ’­æ”¾å†å²è®°å½•

### ä½ä¼˜å…ˆçº§
1. æ·»åŠ  PIP æ¨¡å¼
2. æ·»åŠ æˆªå›¾åŠŸèƒ½
3. æ·»åŠ æ’­æ”¾ç»Ÿè®¡ä¿¡æ¯

## ä½¿ç”¨è¯´æ˜

### å¯åŠ¨æ’­æ”¾å™¨
```dart
Navigator.push(
  context,
  MaterialPageRoute(
    builder: (context) => MpvAndroidPlayerPage(
      url: videoUrl,
      title: videoTitle,
      httpHeaders: headers,
      subtitles: [
        {'title': 'ä¸­æ–‡', 'url': 'https://...', 'language': 'zh'},
        {'title': 'English', 'url': 'https://...', 'language': 'en'},
      ],
    ),
  ),
);
```

### å­—å¹•æ ¼å¼
```dart
List<Map<String, String>> subtitles = [
  {
    'title': 'æ˜¾ç¤ºåç§°',
    'url': 'å­—å¹•æ–‡ä»¶URL',
    'language': 'è¯­è¨€ä»£ç ï¼ˆå¯é€‰ï¼‰',
  },
];
```

## æ€»ç»“

MPV æ’­æ”¾å™¨ç°åœ¨å·²ç»å…·å¤‡äº†ä¸ BetterPlayer ç›¸å½“çš„åŸºç¡€åŠŸèƒ½ï¼š
- âœ… å®Œæ•´çš„éŸ³é¢‘æ”¯æŒï¼ˆä¿®å¤äº†æ— å£°éŸ³é—®é¢˜ï¼‰
- âœ… å­—å¹•åŠ è½½å’Œåˆ‡æ¢
- âœ… æ’­æ”¾æ§åˆ¶ï¼ˆæ’­æ”¾/æš‚åœ/å¿«è¿›/å¿«é€€ï¼‰
- âœ… å€é€Ÿæ’­æ”¾
- âœ… ç½‘é€Ÿæ˜¾ç¤º
- âœ… è¿›åº¦æ¡æ‹–åŠ¨

ç›¸æ¯” BetterPlayerï¼ŒMPV çš„ä¼˜åŠ¿åœ¨äºï¼š
- æ›´å¼ºçš„æ ¼å¼æ”¯æŒï¼ˆTrueHDã€DTS-HDã€PGS å­—å¹•ï¼‰
- æ›´å¥½çš„ç½‘ç»œæµæ’­æ”¾æ€§èƒ½
- å®Œæ•´çš„ FFmpeg æ”¯æŒ

å»ºè®®åœ¨å®é™…è®¾å¤‡ä¸Šæµ‹è¯•å„ç§è§†é¢‘æ ¼å¼å’Œç½‘ç»œæ¡ä»¶ï¼Œç¡®ä¿æ‰€æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œã€‚
